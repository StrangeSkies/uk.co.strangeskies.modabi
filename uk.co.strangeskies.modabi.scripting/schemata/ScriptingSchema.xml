<?xml version="1.0" ?>
<schema
	xmlns="http://modabi.strangeskies.co.uk/2014-01-01/"
	name="ScriptingSchema">

	<imports>
		java.lang.Object,

		javax.script.ScriptEngineManager,
		javax.script.ScriptEngine,
		javax.script.Invocable,

		uk.co.strangeskies.reflection.TypeToken,
		uk.co.strangeskies.reflection.TypeToken.Infer,

		uk.co.strangeskies.modabi.scripting.ScriptObject,
		uk.co.strangeskies.modabi.scripting.ScriptObjectBuilder,
		uk.co.strangeskies.modabi.processing.ProcessingContext,
		uk.co.strangeskies.modabi.schema.Model
	</imports>

	<dependencies>
		BaseSchema
	</dependencies>

	<types />

	<models>
		<model
			name="scriptObject"
			dataType="@Infer ?"
			bindingType="ScriptObjectBuilder{Object}"
			bindingStrategy="STATIC_FACTORY"
			unbindingStrategy="STATIC_FACTORY"
			unbindingFactoryType="ScriptObjectBuilder"
			unbindingType="ScriptObject"
			unbindingMethod="cast"
			extensible="true"
			abstract="true">

			<inputSequence name="build" />

			<property
				name="objectName"
				occurrences="0..1"
				type="string" />

			<data
				name="scriptEngineManager"
				dataType="ScriptEngineManager"
				bindingStrategy="PROVIDED"
				outMethod="null" />

			<data
				name="objectType"
				dataType="TypeToken{?}"
				bindingStrategy="PROVIDED"
				bindingType="ProcessingContext"
				outMethod="null">
				<data
					name="getBindingNode"
					outMethod="null"
					type="int"
					value="1"
					postInputType="Model{?}"
					inMethodChained="true"
					inMethodCast="true" />
				<inputSequence
					name="dataType"
					inMethodChained="true" />
			</data>

			<choice name="scriptSource">
				<sequence name="direct">
					<content
						name="script"
						type="string" />

					<property
						name="language"
						type="string" />
				</sequence>

				<sequence name="resource">
					<property
						name="resource"
						type="string" />

					<property
						name="language"
						type="string"
						optional="true" />
				</sequence>
			</choice>

			<inputSequence
				name="create"
				inMethodChained="true" />

			<inputSequence
				name="cast"
				inMethodChained="true" />
		</model>
	</models>
</schema>
